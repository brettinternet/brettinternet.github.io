{{ $imagePath := .Destination | safeURL }}
{{ $image := resources.Get (strings.TrimPrefix "/static/" $imagePath) }}

{{ if $image }}
  {{ partial "image-processor.html" (dict
    "image" $image
    "alt" .Text
    "class" ""
    "figure" false
    "figure_class" ""
    "caption" ""
  ) }}
{{ else }}
  {{/* Fallback for images that cannot be processed */}}
  <img
    src="{{ .Destination | safeURL }}"
    alt="{{ .Text }}"
    loading="lazy"
  />
{{ end }}
